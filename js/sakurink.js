var titleTime,originTitle=document.title;function cssConModuleOn(){if(CSS.supports("selector(:has(*))"))console.log("【加载兼容】您的浏览器支持 :has()，无需使用备用方案");else{console.log("您的浏览器不支持 :has()，尝试备用方案");if(document.getElementById("srMusic-page")){console.log("MusicPage 已加载，启用兼容方案");const e=document.querySelector("#page");e&&(console.log("实际执行"),e.style.border="0",e.style.boxShadow="none",e.style.padding="0",e.style.background="transparent");const t=document.getElementById("srMusic_bg");t&&(t.style.display="block");const n=document.querySelector("#web_bg");n&&(n.style.display="none");const o=document.querySelector("#nav");o&&(o.style.background="transparent",o.style.boxShadow="none");const c=document.querySelector("#content-inner");c&&(c.style.padding="10px 15px");const s=document.querySelector("#footer");s&&(s.style.display="none");const i=document.querySelector(".aplayer .aplayer-info .aplayer-controller .aplayer-time .aplayer-icon.aplayer-icon-loop");i&&(i.style.marginRight="15px");const a=document.querySelector("#rightside");window.matchMedia("(max-width: 768px)").matches&&a&&(a.style.display="none")}}}function cssConModuleOff(){if(CSS.supports("selector(:has(*))"))console.log("【恢复】您的浏览器支持 :has()，无需使用备用方案");else{console.log("当前非 MusicPage，兼容方案恢复");const e=document.querySelector("#page");e&&(e.style.border="",e.style.boxShadow="",e.style.padding="",e.style.background="");const t=document.querySelector("#srMusic_bg");t&&(t.style.display="");const n=document.querySelector("#web_bg");n&&(n.style.display="");const o=document.querySelector("#nav");o&&(o.style.background="",o.style.boxShadow="");const c=document.querySelector("#content-inner");c&&(c.style.padding="");const s=document.querySelector("#footer");s&&(s.style.display="");const i=document.querySelector(".aplayer .aplayer-info .aplayer-controller .aplayer-time .aplayer-icon.aplayer-icon-loop");i&&(i.style.marginRight="");const a=document.querySelector("#rightside");window.matchMedia("(max-width: 768px)").matches&&a&&(a.style.display="")}}document.addEventListener("visibilitychange",function(){document.hidden?(document.title="w(ﾟДﾟ)w不要走啊！！！ "+originTitle,null!=titleTime&&clearTimeout(titleTime)):(document.title="ヾ(^▽^*)))欢迎回来！ "+originTitle,titleTime=setTimeout(function(){document.title=originTitle},2e3))}),function(){let e=!1;function t(){const t=document.getElementById("aside-content"),n=document.querySelector("#sidebar-menus .menus_items"),o=document.getElementById("aside-content-placeholder");if(!t||!n)return;const c=window.innerWidth<=768;if(c&&!e){const o=document.createElement("div");o.id="aside-content-placeholder",t.parentNode.insertBefore(o,t);const c=document.createElement("div");c.id="mobile-aside-wrapper",c.className="mobile-aside-wrapper",c.appendChild(t),n.parentNode.insertBefore(c,n.nextSibling),e=!0}else if(!c&&e&&o&&o.parentNode){const n=document.getElementById("mobile-aside-wrapper");n&&n.firstElementChild===t&&o.parentNode.replaceChild(t,o),e=!1}}let n;"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t(),window.addEventListener("resize",()=>{clearTimeout(n),n=setTimeout(t,150)})}();var srMusicPageMain={changeMusicBg:function(e=!0){if("/music/"!==window.location.pathname)return console.log("非 music 页"),void cssConModuleOff();!function(){const e=document.getElementById("srMusic_bg"),t=document.getElementById("web_bg");if(!e){const e=document.createElement("div");e.id="srMusic_bg",e.style.transition="background-image 1s ease",t.nextSibling?t.parentNode.insertBefore(e,t.nextSibling):t.parentNode.appendChild(e)}}();const t=document.getElementById("srMusic_bg");if(e){const e=document.querySelector("#srMusic-page .aplayer-pic");t.style.backgroundImage=e.style.backgroundImage}else{const e=new MutationObserver(()=>{cssConModuleOn();const n=document.querySelector("#srMusic-page .aplayer-pic");if(console.info("已加载",t),n){e.disconnect(),t.style.backgroundImage=n.style.backgroundImage,srMusicPageMain.addEventListenerChangeMusicBg();const o=document.querySelector(".aplayerBgMusic");o&&(o.style.display="none",o.aplayer&&o.aplayer.pause())}});e.observe(document.querySelector("#srMusic-page"),{childList:!0,subtree:!0})}},addEventListenerChangeMusicBg:function(){console.log("检测到 music 页");const e=document.getElementById("srMusic-page");e.querySelector(".aplayer-info .aplayer-time .aplayer-icon-menu");e.querySelector("meting-js").aplayer.on("loadeddata",function(){srMusicPageMain.changeMusicBg(),console.info("player loadeddata")})}};function NavElementsAddon(){const e=document.querySelector("#nav > #menus > #search-button");if(!document.getElementById("spNavBtn")){const t=document.createElement("div");t.id="spNavBtn",t.type="button",t.title="控制面板",t.innerHTML='<span class="site-page social-icon dash"><i class="fas fa-gears"></i></span>',e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t),t.addEventListener("click",function(){openPanel()})}}srMusicPageMain.changeMusicBg(!1),window.addEventListener("pjax:complete",NavElementsAddon),document.addEventListener("DOMContentLoaded",NavElementsAddon);