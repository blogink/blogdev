var titleTime,originTitle=document.title;function cssConModuleOn(){if(CSS.supports("selector(:has(*))"))console.log("【加载兼容】您的浏览器支持 :has()，无需使用备用方案");else{console.log("您的浏览器不支持 :has()，尝试备用方案");if(document.getElementById("srMusic-page")){console.log("MusicPage 已加载，启用兼容方案");const e=document.querySelector("#page");e&&(console.log("实际执行"),e.style.border="0",e.style.boxShadow="none",e.style.padding="0",e.style.background="transparent");const t=document.getElementById("srMusic_bg");t&&(t.style.display="block");const n=document.querySelector("#web_bg");n&&(n.style.display="none");const o=document.querySelector("#nav");o&&(o.style.background="transparent",o.style.boxShadow="none");const s=document.querySelector("#content-inner");s&&(s.style.padding="10px 15px");const c=document.querySelector("#footer");c&&(c.style.display="none");const a=document.querySelector(".aplayer .aplayer-info .aplayer-controller .aplayer-time .aplayer-icon.aplayer-icon-loop");a&&(a.style.marginRight="15px");const i=document.querySelector("#rightside");window.matchMedia("(max-width: 768px)").matches&&i&&(i.style.display="none")}}}function cssConModuleOff(){if(CSS.supports("selector(:has(*))"))console.log("【恢复】您的浏览器支持 :has()，无需使用备用方案");else{console.log("当前非 MusicPage，兼容方案恢复");const e=document.querySelector("#page");e&&(e.style.border="",e.style.boxShadow="",e.style.padding="",e.style.background="");const t=document.querySelector("#srMusic_bg");t&&(t.style.display="");const n=document.querySelector("#web_bg");n&&(n.style.display="");const o=document.querySelector("#nav");o&&(o.style.background="",o.style.boxShadow="");const s=document.querySelector("#content-inner");s&&(s.style.padding="");const c=document.querySelector("#footer");c&&(c.style.display="");const a=document.querySelector(".aplayer .aplayer-info .aplayer-controller .aplayer-time .aplayer-icon.aplayer-icon-loop");a&&(a.style.marginRight="");const i=document.querySelector("#rightside");window.matchMedia("(max-width: 768px)").matches&&i&&(i.style.display="")}}document.addEventListener("visibilitychange",(function(){document.hidden?(document.title="w(ﾟДﾟ)w不要走啊！！！ "+originTitle,null!=titleTime&&clearTimeout(titleTime)):(document.title="ヾ(^▽^*)))欢迎回来！ "+originTitle,titleTime=setTimeout((function(){document.title=originTitle}),2e3))}));var srMusicPageMain={changeMusicBg:function(e=!0){if("/music/"!==window.location.pathname)return console.log("非 music 页"),void cssConModuleOff();!function(){const e=document.getElementById("srMusic_bg"),t=document.getElementById("web_bg");if(!e){const e=document.createElement("div");e.id="srMusic_bg",e.style.transition="background-image 1s ease",t.nextSibling?t.parentNode.insertBefore(e,t.nextSibling):t.parentNode.appendChild(e)}}();const t=document.getElementById("srMusic_bg");if(e){const e=document.querySelector("#srMusic-page .aplayer-pic");t.style.backgroundImage=e.style.backgroundImage}else{const e=new MutationObserver((()=>{cssConModuleOn();const n=document.querySelector("#srMusic-page .aplayer-pic");if(console.info("已加载",t),n){e.disconnect(),t.style.backgroundImage=n.style.backgroundImage,srMusicPageMain.addEventListenerChangeMusicBg();const o=document.querySelector(".aplayerBgMusic");o&&(o.style.display="none",o.aplayer&&o.aplayer.pause())}}));e.observe(document.querySelector("#srMusic-page"),{childList:!0,subtree:!0})}},addEventListenerChangeMusicBg:function(){console.log("检测到 music 页");const e=document.getElementById("srMusic-page");e.querySelector(".aplayer-info .aplayer-time .aplayer-icon-menu");e.querySelector("meting-js").aplayer.on("loadeddata",(function(){srMusicPageMain.changeMusicBg(),console.info("player loadeddata")}))}};function NavElementsAddon(){const e=document.querySelector("#nav > #menus > #search-button");if(!document.getElementById("spNavBtn")){const t=document.createElement("div");t.id="spNavBtn",t.type="button",t.title="控制面板",t.innerHTML='<span class="site-page social-icon dash"><i class="fas fa-gears"></i></span>',e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t),t.addEventListener("click",(function(){openPanel()}))}}srMusicPageMain.changeMusicBg(!1),window.addEventListener("pjax:complete",NavElementsAddon),document.addEventListener("DOMContentLoaded",NavElementsAddon);